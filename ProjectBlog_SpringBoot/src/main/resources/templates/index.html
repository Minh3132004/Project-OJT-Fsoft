<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 100px 0;
        }
        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
        }
        .footer {
            background: #2c3e50;
            color: white;
            padding: 50px 0;
            margin-top: 80px;
        }
        .feature-icon {
            font-size: 3rem;
            color: #667eea;
            margin-bottom: 1rem;
        }
        .stats-section {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 60px 0;
        }
        .stat-item {
            text-align: center;
            padding: 20px;
        }
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #667eea;
        }
        .btn-primary-custom {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            border-radius: 30px;
            padding: 12px 30px;
            font-weight: 500;
        }
        .btn-primary-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }
        .dropdown-toggle::after {
            display: none;
        }
        .dropdown-menu {
            border: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-radius: 10px;
        }
        .dropdown-item {
            padding: 8px 16px;
            transition: all 0.3s ease;
        }
        .dropdown-item:hover {
            background-color: #f8f9fa;
            color: #667eea;
        }
        .nav-link.login-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white !important;
            border-radius: 20px;
            padding: 8px 16px !important;
            margin: 0 5px;
            transition: all 0.3s ease;
        }
        .nav-link.login-btn:hover {
            background: linear-gradient(45deg, #218838, #1ea085);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }
        .nav-link.register-btn {
            background: linear-gradient(45deg, #007bff, #6610f2);
            color: white !important;
            border-radius: 20px;
            padding: 8px 16px !important;
            margin: 0 5px;
            transition: all 0.3s ease;
        }
        .nav-link.register-btn:hover {
            background: linear-gradient(45deg, #0056b3, #520dc2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
        }
        .comment-item {
            border-left: 3px solid #667eea;
            transition: all 0.3s ease;
        }
        .comment-item:hover {
            background-color: #f8f9fa !important;
            transform: translateX(5px);
        }
        .comments-list {
            max-height: 300px;
            overflow-y: auto;
        }
        .comments-section {
            border-top: 1px solid #e9ecef;
            padding-top: 15px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-blog me-2"></i>Blog
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#features">Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#contact">Contact</a>
                    </li>
                    
                    <!-- User is logged in (not anonymous) -->
                    <li class="nav-item" th:if="${#authentication.isAuthenticated() and !#authentication.name.equals('anonymousUser')}">
                        <a class="nav-link" href="/posts/new">
                            <i class="fas fa-plus me-1"></i>Add Post
                        </a>
                    </li>
                    <li class="nav-item" th:if="${#authentication.isAuthenticated() and !#authentication.name.equals('anonymousUser')}">
                        <div class="dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                                <i class="fas fa-user me-1"></i>
                                <span th:text="${#authentication.name}">User</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#"><i class="fas fa-user me-2"></i>Profile</a></li>
                                <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Settings</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li>
                                    <form th:action="@{/logout}" method="post" class="px-3 py-1">
                                        <button type="submit" class="dropdown-item">
                                            <i class="fas fa-sign-out-alt me-2"></i>Logout
                                        </button>
                                    </form>
                                </li>
                            </ul>
                        </div>
                    </li>
                    
                    <!-- User is not logged in (anonymous) -->
                    <li class="nav-item" th:if="${!#authentication.isAuthenticated() or #authentication.name.equals('anonymousUser')}">
                        <a class="nav-link login-btn" href="/login">
                            <i class="fas fa-sign-in-alt me-1"></i>Login
                        </a>
                    </li>
                    <li class="nav-item" th:if="${!#authentication.isAuthenticated() or #authentication.name.equals('anonymousUser')}">
                        <a class="nav-link register-btn" href="/register">
                            <i class="fas fa-user-plus me-1"></i>Register
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section text-center">
        <div class="container">
            <h1 class="display-3 fw-bold mb-4">Welcome to Our Blog</h1>
            <p class="lead mb-4">A modern blog platform featuring user management, post creation, and interactive comments</p>
            <div class="d-flex justify-content-center gap-3">
                <a href="#features" class="btn btn-light btn-lg">
                    <i class="fas fa-arrow-down me-2"></i>Learn More
                </a>
                <a href="#about" class="btn btn-outline-light btn-lg">
                    <i class="fas fa-info-circle me-2"></i>About Us
                </a>
            </div>
        </div>
    </section>

    <!-- Latest Posts -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">
                    <h2 class="text-center mb-5">Latest Posts</h2>
                    <div class="row" th:if="${posts}!=null and ${!posts.isEmpty()}">
                        <div class="col-md-6 mb-4" th:each="post : ${posts}">
                            <div class="card h-100">
                                <div class="card-body d-flex flex-column">
                                    <h5 class="card-title">
                                        <a th:href="@{'/posts/' + ${post.id}}" class="text-decoration-none" th:text="${post.title}">Post title</a>
                                    </h5>
                                    <p class="card-text flex-grow-1" th:text="${#strings.abbreviate(post.content, 140)}">Post content preview</p>
                                    <div class="text-muted small mb-3">
                                        <span th:text="${#temporals.format(post.createdAt, 'dd/MM/yyyy HH:mm')}">date</span>
                                    </div>
                                    
                                    <!-- Comments Section -->
                                    <div class="mt-3">
                                        <h6 class="text-muted mb-2">
                                            <i class="fas fa-comments me-1"></i>
                                            Comments (<span th:text="${#lists.size(post.comments)}">0</span>)
                                        </h6>
                                        
                                        <!-- Hiển thị comments -->
                                        <div class="comments-list" th:if="${!post.comments.isEmpty()}">
                                            <div class="comment-item mb-2 p-2 bg-light rounded" 
                                                 th:each="comment, commentStat : ${post.comments}"
                                                 th:if="${commentStat.index < 3}">
                                                <div>
                                                    <strong class="text-primary" th:text="${comment.authorName}">Author</strong>
                                                    <small class="text-muted ms-2" th:text="${#temporals.format(comment.createdAt, 'dd/MM HH:mm')}">date</small>
                                                </div>
                                                <p class="mb-0 mt-1" th:text="${comment.content}">Comment content</p>
                                            </div>
                                            
                                            <!-- Link xem tất cả nếu có nhiều hơn 3 comments -->
                                            <div class="text-center mt-2" th:if="${#lists.size(post.comments) > 3}">
                                                <a th:href="@{'/posts/' + ${post.id}}" class="btn btn-sm btn-link">
                                                    <i class="fas fa-eye me-1"></i>
                                                    View all <span th:text="${#lists.size(post.comments)}">0</span> comments
                                                </a>
                                            </div>
                                        </div>
                                        
                                        <!-- Không có comments -->
                                        <div class="text-muted small" th:if="${post.comments.isEmpty()}">
                                            <i class="fas fa-comment-slash me-1"></i>No comments yet. Be the first to comment!
                                        </div>
                                    </div>

                                    <div class="d-flex gap-2 mt-3">
                                        <!-- Comment button -->
                                        <a class="btn btn-sm btn-outline-success" th:href="@{'/comments/' + ${post.id}}">
                                            <i class="fas fa-comment me-1"></i>Add Comment
                                        </a>
                                        
                                        <!-- Edit/Delete buttons -->
                                        <div th:if="${currentUserId}!=null and ${currentUserId} == ${post.authorId}" class="d-flex gap-2">
                                            <a class="btn btn-sm btn-outline-primary" th:href="@{'/posts/' + ${post.id} + '/edit'}">
                                                <i class="fas fa-edit me-1"></i>Edit
                                            </a>
                                            <form th:action="@{'/posts/' + ${post.id} + '/delete'}" method="post" onsubmit="return confirm('Delete this post?');">
                                                <button type="submit" class="btn btn-sm btn-outline-danger">
                                                    <i class="fas fa-trash me-1"></i>Delete
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-center text-muted" th:if="${posts}==null or ${posts.isEmpty()}">
                        No posts yet.
                    </div>
                </div>
            </div>
        </div>
    </section>


    <!-- Features Section -->
    <section id="features" class="py-5 bg-light">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="mb-5">Platform Features</h2>
                    <div class="row">
                        <div class="col-md-4 mb-4">
                            <div class="feature-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <h5>User Management</h5>
                            <p>Secure user registration and authentication system with role-based access control.</p>
                        </div>
                        <div class="col-md-4 mb-4">
                            <div class="feature-icon">
                                <i class="fas fa-edit"></i>
                            </div>
                            <h5>Content Creation</h5>
                            <p>Easy-to-use interface for creating and managing blog posts with rich text editing.</p>
                        </div>
                        <div class="col-md-4 mb-4">
                            <div class="feature-icon">
                                <i class="fas fa-comments"></i>
                            </div>
                            <h5>Interactive Comments</h5>
                            <p>Engage with your audience through a robust commenting system with moderation tools.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="mb-4">About This Blog Platform</h2>
                    <p class="lead">This is a modern blog application featuring a clean and responsive design. The platform demonstrates best practices in web development including MVC architecture, database integration, and security implementation.</p>
                    <div class="row mt-5">
                        <div class="col-md-6">
                            <h5><i class="fas fa-code me-2"></i>Features</h5>
                            <ul class="list-unstyled">
                                <li><i class="fas fa-check text-success me-2"></i>User Management</li>
                                <li><i class="fas fa-check text-success me-2"></i>Post Creation</li>
                                <li><i class="fas fa-check text-success me-2"></i>Comment System</li>
                                <li><i class="fas fa-check text-success me-2"></i>Responsive Design</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h5><i class="fas fa-tools me-2"></i>Tools & Design</h5>
                            <ul class="list-unstyled">
                                <li><i class="fas fa-check text-success me-2"></i>Modern UI/UX</li>
                                <li><i class="fas fa-check text-success me-2"></i>Mobile Friendly</li>
                                <li><i class="fas fa-check text-success me-2"></i>Fast Loading</li>
                                <li><i class="fas fa-check text-success me-2"></i>Easy Navigation</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5><i class="fas fa-blog me-2"></i>Our Blog</h5>
                    <p>Welcome to our blog where you can share your thoughts and ideas with the community.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <h5>Connect With Us</h5>
                    <div class="social-links">
                        <a href="#" class="text-white me-3"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-linkedin"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-github"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            <hr class="my-4">
            <div class="text-center">
                <p>&copy; 2024 Our Blog. All rights reserved. Built with <i class="fas fa-heart text-danger"></i> for sharing knowledge.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
